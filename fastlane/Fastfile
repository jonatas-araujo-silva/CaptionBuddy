# fastlane/Fastfile

default_platform(:ios)

platform :ios do
  # This lane runs all your unit and UI tests.
  lane :tests do
    run_tests(scheme: "CaptionBuddy")
  end

  # This lane builds and deploys the app to TestFlight.
  lane :beta do
    # Ensure we run tests before deploying.
    tests

    # Automatically increment the build number.
    increment_build_number(xcodeproj: "CaptionBuddy.xcodeproj")

    # Build the app.
    build_app(workspace: "CaptionBuddy.xcworkspace", scheme: "CaptionBuddy")

    # Upload the build to TestFlight.
    # This requires an App Store Connect API Key.
    upload_to_testflight(
      api_key_path: "fastlane/api_key.json"
    )
  end
end